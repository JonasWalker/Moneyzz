<!DOCTYPE html>
<html lang="en">
  <head>
    <!--Import Google Icon Font-->
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />
    <!--Import materialize.css-->
    <link
      type="text/css"
      rel="stylesheet"
      href="css/materialize.min.css"
      media="screen,projection"
    />

    <!--Let browser know website is optimized for mobile-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Moneyzz</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css"
    />
  </head>
  <body>
    <nav>
      <div class="nav-wrappper">
        <a class="brand-logo center">Moneyzz</a>
      </div>
    </nav>
    <div class="row" style="width: 20%; float: left" class="left-align">
      <form class="col s12">
        <div class="row">
          <div class="input-field col s6">
            <input
              placeholder="Enter Salary"
              id="totalSalary"
              type="text"
              onblur="upDateDatabase()"
            />
            <label class="active" for="totalSalary">Total Salary</label>
          </div>
        </div>
        <div class="row">
          <div class="input-field col s6">
            <input
              placeholder="Enter Total Mortgages"
              type="text"
              id="totalMortgage"
              name="totalMortgage"
            />
            <label class="active" for="totalMortgage">Total Mortgage</label>
          </div>
        </div>
        <div class="row">
          <div class="input-field col s6">
            <input
              placeholder="Enter Total Car Loans"
              type="text"
              id="totalCarLoan"
              name="totalCarLoan"
              onblur="upDateDatabase()"
            />
            <label class="active" for="totalCarLoan">Total Car Loan</label>
          </div>
        </div>
        <div class="row">
          <div class="input-field col s6">
            <input
              placeholder="Enter Total Bills"
              type="text"
              id="totalBills"
              name="totalBills"
              onblur="upDateDatabase()"
            />
            <label class="active" for="totalBills">Total Bills</label>
          </div>
        </div>
        <div class="row">
          <div class="input-field col s6">
            <input
              placeholder="Enter Monthly Income"
              type="text"
              id="monthlyIncome"
              name="monthlyIncome"
              onblur="upDateDatabase()"
            />
            <label class="active" for="monthlyIncome">Monthly Income</label>
          </div>
        </div>
        <div class="row">
          <div class="input-field col s8">
            <input
              placeholder="Enter Monthly Car Payment"
              type="text"
              id="monthlyCarPay"
              name="monthlyCarPay"
              onblur="upDateDatabase()"
            />
            <label class="active" for="monthlyCarPay"
              >Monthly Car Payment</label
            >
          </div>
        </div>
        <div class="row">
          <div class="input-field col s10">
            <input
              placeholder="Enter Monthly Mortgage Payment"
              type="text"
              id="monthlyMortgagePay"
              name="monthlyMortgagePay"
              onblur="upDateDatabase()"
            />
            <label class="active" for="monthlyMortgagePay"
              >Monthly Mortgage Payment</label
            >
          </div>
        </div>
        <div class="row">
          <div class="input-field col s6">
            <input
              placeholder="Enter Total Bills"
              type="text"
              id="monthlyBills"
              name="monthlyBills"
              onblur="upDateDatabase()"
            />
            <label class="active" for="monthlyBills">Monthly Bills</label>
          </div>
        </div>
        <!-- <button class="btn waves-effect waves-light" type="submit">
          add item
        </button> -->
      </form>
    </div>
    <ul></ul>
    <!-- canvas for piechart -->
    <div>
      <canvas
        style="width: 70%; float: right; margin-top: -30%"
        class="left-align"
        id="myChart"
      ></canvas>
    </div>
    <!--   <br style="clear: both" /> -->

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
      /* // SQL stuff
      const electron = require('electron')
      const { ipcRenderer } = electron
      const ul = document.querySelector('ul')

      //auto-populate the info
      var mysql = require('mysql')

      var connection = mysql.createConnection({
        host: '127.0.0.1',
        user: 'JonasWalker',
        password: 'jonas1999',
        database: 'Moneyz',
      })
      connection.connect()

      connection.query(
        'SELECT salary FROM moneyz.accountinfo;',
        function (error, results, fields) {
          if (error) throw error
          console.log(results)
          document.getElementById('item').value = results[0].salary
        }
      ) */

      var temp = 0

      // Add item
      //ipcRenderer.on('item:add', function (e, item) {
      //document.getElementById('item').value = item
      //temp = document.getElementById('item').value
      //connection.query(
      //'UPDATE moneyz.accountinfo SET salary = ' + item + ';',
      //function (error, results, fields) {
      //  if (error) throw error
      //}
      //)
      //})
      // console.log('test123')
      section1 = 120
      section2 = 120
      section3 = 120

      // === include 'setup' then 'config' above ===

      const data = {
        labels: ['Mortgage', 'Bills', 'Loans'],
        datasets: [
          {
            label: 'My Fiances',
            data: [section1, section2, section3],
            backgroundColor: [
              'rgb(255, 99, 132)',
              'rgb(54, 162, 235)',
              'rgb(255, 205, 86)',
            ],
            hoverOffset: 4,
          },
        ],
      }

      const config = {
        type: 'pie',
        data: data,
        options: {
          layout: {
            padding: {
              left: 1000,
              right: 500,
              top: 0,
              bottom: 1500,
            },
          },
        },
      }

      var myChart = new Chart(document.getElementById('myChart'), config)

      //connection.end()
    </script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
      // Fills everything onLoad
      window.onload = function whenOpen() {
        // SQL stuff
        const electron = require('electron')
        const { ipcRenderer } = electron
        const ul = document.querySelector('ul')

        //auto-populate the info
        var mysql = require('mysql')

        console.log('test')

        var connection = mysql.createConnection({
          host: '127.0.0.1',
          user: 'JonasWalker',
          password: 'jonas1999',
          database: 'Moneyz',
        })

        connection.connect()

        connection.query(
          'SELECT * FROM moneyz.accountinfo;',
          function (error, results, fields) {
            if (error) throw error
            console.log(results)
            document.getElementById('totalSalary').value = results[0].salary
            document.getElementById('totalMortgage').value =
              results[0].totalMortgages
            document.getElementById('totalCarLoan').value =
              results[0].totalCarLoans
            document.getElementById('totalBills').value = results[0].totalBills
            //document.getElementById('item').value = results[0].salary
          }
        )
        connection.end()
      }
    </script>

    <script>
      function upDateDatabase() {
        // SQL stuff
        const electron = require('electron')
        const { ipcRenderer } = electron
        const ul = document.querySelector('ul')

        //auto-populate the info
        var mysql = require('mysql')

        var connection = mysql.createConnection({
          host: '127.0.0.1',
          user: 'JonasWalker',
          password: 'jonas1999',
          database: 'Moneyz',
        })

        connection.connect()

        var item1 = document.getElementById('totalSalary').value
        var item2 = document.getElementById('totalMortgage').value
        var item3 = document.getElementById('totalCarLoan').value
        var item4 = document.getElementById('totalBills').value

        connection.query(
          'UPDATE accountinfo SET salary ="' +
            item1 +
            '", totalMortgages = "' +
            item2 +
            '", totalCarLoans = "' +
            item3 +
            '", totalBills = "' +
            item4 +
            '";',
          function (error, results, fields) {
            if (error) throw error
            console.log(results)
            document.getElementById('totalSalary').value = results[0].salary
            document.getElementById('totalMortgage').value =
              results[0].totalMortgages
            document.getElementById('totalCarLoan').value =
              results[0].totalCarLoans
            document.getElementById('totalBills').value = results[0].totalBills
            //document.getElementById('item').value = results[0].salary
          }
        )
      }
    </script>

    <!--JavaScript at end of body for optimized loading-->
    <script type="text/javascript" src="js/materialize.min.js"></script>
  </body>
</html>
<!--"UPDATE accountinfo SET salary =" + item + ", totalMortgages = " + item + ", totalBills = " + item + ", totalCarLoans = " + item + ";" -->
